<!DOCTYPE html>
<html>
<head>
  <title>Checkout</title>
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <h1>Checkout</h1>
  <p>Total: $<%= total.toFixed(2) %></p>
  <div id="cart-items">
    <% cart.forEach(item => { %>
      <p><%= item.name %> x <%= item.quantity %> = $<%= (item.price * item.quantity).toFixed(2) %></p>
    <% }) %>
  </div>
  <button id="checkout-button">Pay with Stripe</button>

  <script>
    const stripe = Stripe('<%= stripePublishableKey %>');
    const checkoutButton = document.getElementById('checkout-button');

    checkoutButton.addEventListener('click', () => {
      fetch('/create-checkout-session', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
      })
      .then(res => res.json())
      .then(session => stripe.redirectToCheckout({ sessionId: session.id }))
      .catch(err => alert('Error: ' + err));
    });
  </script>
</body>
</html>
